<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Kalkulator chleba â€“ 3 mÄ…ki + gluten + levain</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 1rem;
      line-height: 1.4;
    }
    h1 { font-size: 1.2rem; margin-bottom: 0.5rem; }
    h2 { font-size: 1rem; margin-top: 1.2rem; margin-bottom: 0.3rem; }

    .grid {
      display: grid;
      grid-template-columns: 1.3fr 1fr;
      gap: 0.3rem 0.6rem;
      max-width: 600px;
      align-items: center;
    }

    label {
      font-size: 0.86rem;
    }

    /* Bazowy wyglÄ…d wszystkich pÃ³l (spÃ³jne rozmiary, obramowanie) */
    input[type="number"],
    input[type="text"],
    textarea {
      width: 100%;
      box-sizing: border-box;
      padding: 0.35rem 0.45rem;
      font-size: 0.86rem;
      border: 1px solid #cccccc;
      border-radius: 6px;
    }

    .section {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 0.7rem;
      margin-bottom: 0.8rem;
    }

    .row {
      display: grid;
      grid-template-columns: 1fr 0.8fr 0.8fr 0.9fr;
      gap: 0.3rem;
      margin-bottom: 0.2rem;
    }

    .row input[type="number"],
    .row input[type="text"] {
      font-size: 0.8rem;
      padding: 0.25rem 0.35rem;
    }

    .hint {
      font-size: 0.75rem;
      color: #555;
      margin-bottom: 0.4rem;
    }

    .btn {
      margin-top: 0.4rem;
      margin-right: 0.4rem;
      padding: 0.35rem 0.8rem;
      font-size: 0.8rem;
      border-radius: 999px;
      border: 1px solid #888;
      background: #f3f3f3;
      cursor: pointer;
    }

    .btn:hover {
      background: #e8e8e8;
    }

    .output {
      font-weight: 600;
      color: #222;
      /* wyglÄ…d jak â€szare pole wynikoweâ€ */
      background-color: #f5f5f5;
      padding: 0.25rem 0.35rem;
      border-radius: 6px;
      border: 1px solid #dddddd;
      min-height: 1.8rem;
      display: inline-flex;
      align-items: center;
      box-sizing: border-box;
    }

    #recipeSummary {
      min-height: 120px;
      resize: vertical;
    }

    /* Pola edytowalne â€“ jasnoniebieskie tÅ‚o + animacja */
    input[type="number"]:not([readonly]),
    input[type="text"]:not([readonly]),
    textarea:not([readonly]) {
      background-color: #e6f4ff;
      transition: background-color 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease;
    }

    /* Efekt po wejÅ›ciu w pole (focus) â€“ delikatne podÅ›wietlenie */
    input[type="number"]:not([readonly]):focus,
    input[type="text"]:not([readonly]):focus,
    textarea:not([readonly]):focus {
      background-color: #d8eeff; /* jaÅ›niejszy niebieski */
      box-shadow: 0 0 0 2px #99cfff;
      border-color: #66aef5;
      outline: none;
    }

    /* Pola wynikowe (readonly) â€“ szare, spokojne tÅ‚o */
    input[readonly] {
      background-color: #f5f5f5;
      border-color: #dddddd;
      cursor: default;
    }

    textarea[readonly] {
      background-color: #f5f5f5;
      border-color: #dddddd;
      cursor: default;
    }

    /* Tabelka udziaÅ‚u mÄ…k w mieszance */
    .flour-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 0.6rem;
      font-size: 0.8rem;
    }

    .flour-table th,
    .flour-table td {
      border: 1px solid #dddddd;
      padding: 0.25rem 0.35rem;
      text-align: right;
    }

    .flour-table th:first-child,
    .flour-table td:first-child {
      text-align: left;
    }

    .flour-table thead {
      background-color: #f3f3f3;
    }
  </style>
</head>
<body>

<h1>Kalkulator chleba â€“ 3 mÄ…ki + gluten + levain</h1>

<div class="section">
  <h2>1. Suma suchych produktÃ³w</h2>
  <div class="grid">
    <label for="totalDry">Suma suchych (mÄ…ki + gluten) [g]</label>
    <input type="number" id="totalDry" step="1" oninput="recalc()">
  </div>
  <p class="hint">To nadrzÄ™dna wartoÅ›Ä‡ â€“ docelowa Å‚Ä…czna masa: mÄ…ki (3 rodzaje) + gluten spoÅ¼ywczy.</p>
</div>

<div class="section">
  <h2>2. MÄ…ki</h2>
  <p class="hint">Wpisz masy mÄ…k. Po dodaniu glutenu moÅ¼esz uÅ¼yÄ‡ przycisku â€Przeskalujâ€, Å¼eby mÄ…ki + gluten = suma suchych.</p>
  <div class="row">
    <label>Typ</label>
    <label>IloÅ›Ä‡ [g]</label>
    <label>% glutenu</label>
    <label>Gluten z mÄ…ki [g]</label>
  </div>

  <div class="row">
    <input type="text" id="flourName1" placeholder="np. T110" oninput="recalc()">
    <input type="number" id="m1" step="1" oninput="recalc()">
    <input type="number" id="p1" step="0.1" oninput="recalc()">
    <input type="number" id="g1" readonly>
  </div>

  <div class="row">
    <input type="text" id="flourName2" placeholder="np. T80 ancient" oninput="recalc()">
    <input type="number" id="m2" step="1" oninput="recalc()">
    <input type="number" id="p2" step="0.1" oninput="recalc()">
    <input type="number" id="g2" readonly>
  </div>

  <div class="row">
    <input type="text" id="flourName3" placeholder="np. T65" oninput="recalc()">
    <input type="number" id="m3" step="1" oninput="recalc()">
    <input type="number" id="p3" step="0.1" oninput="recalc()">
    <input type="number" id="g3" readonly>
  </div>

  <div class="grid" style="margin-top:0.4rem;">
    <label for="glutenProd">Gluten spoÅ¼ywczy (80%) [g]</label>
    <input type="number" id="glutenProd" step="0.5" oninput="recalc()">
  </div>

  <button class="btn" onclick="scaleFlours()">Przeskaluj mÄ…ki do sumy suchych</button>

  <div class="grid" style="margin-top:0.6rem;">
    <span>ğŸ‘â€ğŸ—¨ Suma mÄ…k + gluten [g]</span>
    <span class="output" id="sumDryDisplay">â€“</span>
    <span>Suma glutenu [g]</span>
    <span class="output" id="sumGlutenDisplay">â€“</span>
    <span>Aktualny % glutenu mieszanki</span>
    <span class="output" id="glutenPercentDisplay">â€“</span>
  </div>

  <h3 style="font-size:0.9rem; margin-top:0.8rem; margin-bottom:0.3rem;">UdziaÅ‚ mÄ…k w mieszance (bez glutenu)</h3>
  <table class="flour-table">
    <thead>
      <tr>
        <th>MÄ…ka</th>
        <th>IloÅ›Ä‡ [g]</th>
        <th>UdziaÅ‚ [%]</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td id="ftName1">MÄ…ka 1</td>
        <td id="ftGrams1">â€“</td>
        <td id="ftPct1">â€“</td>
      </tr>
      <tr>
        <td id="ftName2">MÄ…ka 2</td>
        <td id="ftGrams2">â€“</td>
        <td id="ftPct2">â€“</td>
      </tr>
      <tr>
        <td id="ftName3">MÄ…ka 3</td>
        <td id="ftGrams3">â€“</td>
        <td id="ftPct3">â€“</td>
      </tr>
    </tbody>
  </table>
</div>

<div class="section">
  <h2>3. Zakwas / levain</h2>
  <div class="grid">
    <label for="levain">Levain / zakwas [g]</label>
    <input type="number" id="levain" step="1" oninput="recalc()">

    <label for="levainHydro">Hydratacja levain [%]</label>
    <input type="number" id="levainHydro" step="1" oninput="recalc()">

    <span>MÄ…ka w levain [g]</span>
    <span class="output" id="levainFlourDisplay">â€“</span>

    <span>Woda w levain [g]</span>
    <span class="output" id="levainWaterDisplay">â€“</span>
  </div>
</div>

<div class="section">
  <h2>4. Hydratacja ciasta</h2>
  <div class="grid">
    <label for="targetHydro">Docelowa hydratacja ciasta [%]</label>
    <input type="number" id="targetHydro" step="0.5" oninput="recalc()">

    <span>CaÅ‚kowita mÄ…ka (mÄ…ki + gluten + mÄ…ka z levain) [g]</span>
    <span class="output" id="totalFlourDisplay">â€“</span>

    <span>CaÅ‚kowita woda (w tym levain) [g]</span>
    <span class="output" id="totalWaterDisplay">â€“</span>

    <span>Woda do dodania do ciasta [g]</span>
    <span class="output" id="addedWaterDisplay">â€“</span>
  </div>
</div>

<div class="section">
  <h2>5. Podsumowanie przepisu</h2>
  <p class="hint">Kliknij â€ZAPISZ PRZEPISâ€, aby wygenerowaÄ‡ tekstowy opis aktualnego chleba. MoÅ¼esz go skopiowaÄ‡ do notatek.</p>
  <button class="btn" onclick="generateRecipe()">ZAPISZ PRZEPIS</button>
  <button class="btn" onclick="clearFields()">WYCZYÅšÄ† POLA</button>
  <textarea id="recipeSummary" placeholder="Tutaj pojawi siÄ™ podsumowanie przepisu..." readonly></textarea>
</div>

<script>
function num(id) {
  var el = document.getElementById(id);
  if (!el) return 0;
  var raw = el.value || "";
  raw = raw.replace(",", "."); // na wszelki wypadek, gdy wpiszesz przecinek
  var v = parseFloat(raw);
  if (isNaN(v)) return 0;
  return v;
}

function val(id) {
  var el = document.getElementById(id);
  return el ? el.value : "";
}

function setValue(id, val, decimals) {
  if (typeof decimals === "undefined") decimals = 1;
  var el = document.getElementById(id);
  if (!el) return;
  if (typeof val === "number" && !isNaN(val)) {
    el.value = val.toFixed(decimals);
  } else {
    el.value = "";
  }
}

function setText(id, val, decimals) {
  if (typeof decimals === "undefined") decimals = 1;
  var el = document.getElementById(id);
  if (!el) return;
  if (typeof val === "number" && !isNaN(val)) {
    el.textContent = val.toFixed(decimals);
  } else {
    el.textContent = "â€“";
  }
}

function setTableRow(nameId, gramsId, pctId, name, grams, totalFlour) {
  var nameEl = document.getElementById(nameId);
  var gEl = document.getElementById(gramsId);
  var pEl = document.getElementById(pctId);
  if (!nameEl || !gEl || !pEl) return;

  nameEl.textContent = name;

  if (grams > 0 && totalFlour > 0) {
    gEl.textContent = grams.toFixed(1);
    pEl.textContent = (grams / totalFlour * 100).toFixed(1) + " %";
  } else if (grams > 0 && totalFlour === 0) {
    gEl.textContent = grams.toFixed(1);
    pEl.textContent = "â€“";
  } else {
    gEl.textContent = "â€“";
    pEl.textContent = "â€“";
  }
}

function recalc() {
  var m1 = num("m1"), m2 = num("m2"), m3 = num("m3");
  var p1 = num("p1"), p2 = num("p2"), p3 = num("p3");
  var Gprod = num("glutenProd");

  var g1 = m1 * p1 / 100;
  var g2 = m2 * p2 / 100;
  var g3 = m3 * p3 / 100;
  setValue("g1", g1, 1);
  setValue("g2", g2, 1);
  setValue("g3", g3, 1);

  var sumDry = m1 + m2 + m3 + Gprod;
  var sumGluten = g1 + g2 + g3 + Gprod * 0.8;
  var glutenPercent = sumDry > 0 ? (sumGluten / sumDry * 100) : NaN;

  setText("sumDryDisplay", sumDry, 1);
  setText("sumGlutenDisplay", sumGluten, 1);
  setText("glutenPercentDisplay", glutenPercent, 2);

  // Tabelka udziaÅ‚u mÄ…k (bez glutenu)
  var totalFlourBlend = m1 + m2 + m3;
  var fn1 = val("flourName1") || "MÄ…ka 1";
  var fn2 = val("flourName2") || "MÄ…ka 2";
  var fn3 = val("flourName3") || "MÄ…ka 3";

  setTableRow("ftName1", "ftGrams1", "ftPct1", fn1, m1, totalFlourBlend);
  setTableRow("ftName2", "ftGrams2", "ftPct2", fn2, m2, totalFlourBlend);
  setTableRow("ftName3", "ftGrams3", "ftPct3", fn3, m3, totalFlourBlend);

  var L = num("levain");
  var Lh = num("levainHydro");
  var levainFlour = 0;
  var levainWater = 0;
  if (L > 0 && Lh > 0) {
    levainFlour = L / (1 + Lh / 100);
    levainWater = L - levainFlour;
  }
  setText("levainFlourDisplay", levainFlour, 1);
  setText("levainWaterDisplay", levainWater, 1);

  var totalFlour = sumDry + levainFlour;
  var targetHydro = num("targetHydro");
  var totalWater = (totalFlour > 0 && targetHydro > 0) ? totalFlour * targetHydro / 100 : NaN;
  var addedWater = totalWater - levainWater;

  setText("totalFlourDisplay", totalFlour, 1);
  setText("totalWaterDisplay", totalWater, 1);
  setText("addedWaterDisplay", addedWater, 1);
}

function scaleFlours() {
  var T = num("totalDry");
  var G = num("glutenProd");
  if (T <= 0) {
    alert("Najpierw ustaw 'Suma suchych (mÄ…ki + gluten)'.");
    return;
  }

  var m1 = num("m1"), m2 = num("m2"), m3 = num("m3");
  var F = m1 + m2 + m3;
  if (F <= 0) {
    alert("Najpierw wpisz iloÅ›ci mÄ…k.");
    return;
  }

  var flourTarget = T - G;
  if (flourTarget < 0) {
    alert("Glutenu jest wiÄ™cej niÅ¼ suma suchych! Zmniejsz gluten albo zwiÄ™ksz sumÄ™.");
    return;
  }

  var k = flourTarget / F;
  setValue("m1", m1 * k, 1);
  setValue("m2", m2 * k, 1);
  setValue("m3", m3 * k, 1);
  recalc();
}

function clearFields() {
  var ids = [
    "totalDry", "flourName1", "flourName2", "flourName3",
    "m1", "m2", "m3",
    "p1", "p2", "p3",
    "glutenProd",
    "levain", "levainHydro",
    "targetHydro"
  ];
  for (var i = 0; i < ids.length; i++) {
    var el = document.getElementById(ids[i]);
    if (el) el.value = "";
  }

  var outInputs = ["g1", "g2", "g3"];
  for (var j = 0; j < outInputs.length; j++) {
    var e2 = document.getElementById(outInputs[j]);
    if (e2) e2.value = "";
  }

  var textIds = [
    "sumDryDisplay", "sumGlutenDisplay", "glutenPercentDisplay",
    "levainFlourDisplay", "levainWaterDisplay",
    "totalFlourDisplay", "totalWaterDisplay", "addedWaterDisplay"
  ];
  for (var k = 0; k < textIds.length; k++) {
    var e3 = document.getElementById(textIds[k]);
    if (e3) e3.textContent = "â€“";
  }

  var summary = document.getElementById("recipeSummary");
  if (summary) summary.value = "";

  // zresetuj tabelkÄ™ przez przeliczenie na pustych polach
  recalc();
}

function generateRecipe() {
  var totalDry = num("totalDry");
  var fn1 = val("flourName1") || "MÄ…ka 1";
  var fn2 = val("flourName2") || "MÄ…ka 2";
  var fn3 = val("flourName3") || "MÄ…ka 3";
  var m1 = num("m1"), m2 = num("m2"), m3 = num("m3");
  var p1 = num("p1"), p2 = num("p2"), p3 = num("p3");
  var Gprod = num("glutenProd");
  var sumDryText = document.getElementById("sumDryDisplay").textContent;
  var sumGlutenText = document.getElementById("sumGlutenDisplay").textContent;
  var glutenPctText = document.getElementById("glutenPercentDisplay").textContent;

  var L = num("levain");
  var Lh = num("levainHydro");
  var levFlourText = document.getElementById("levainFlourDisplay").textContent;
  var levWaterText = document.getElementById("levainWaterDisplay").textContent;

  var targetHydro = num("targetHydro");
  var totalFlourText = document.getElementById("totalFlourDisplay").textContent;
  var totalWaterText = document.getElementById("totalWaterDisplay").textContent;
  var addedWaterText = document.getElementById("addedWaterDisplay").textContent;

  var lines = [];
  lines.push("PRZEPIS â€“ chleb na zakwasie");
  lines.push("");
  if (totalDry > 0) {
    lines.push("Suma suchych (mÄ…ki + gluten): " + totalDry.toFixed(1) + " g");
  }
  lines.push("");
  lines.push("MÄ…ki:");
  if (m1 > 0) lines.push("- " + fn1 + ": " + m1.toFixed(1) + " g (" + p1.toFixed(1) + " % glutenu)");
  if (m2 > 0) lines.push("- " + fn2 + ": " + m2.toFixed(1) + " g (" + p2.toFixed(1) + " % glutenu)");
  if (m3 > 0) lines.push("- " + fn3 + ": " + m3.toFixed(1) + " g (" + p3.toFixed(1) + " % glutenu)");
  if (Gprod > 0) lines.push("- Gluten spoÅ¼ywczy (80%): " + Gprod.toFixed(1) + " g");

  lines.push("");
  lines.push("Podsumowanie glutenu:");
  if (sumDryText !== "â€“") lines.push("- Suma suchych (z mÄ…k + gluten): " + sumDryText + " g");
  if (sumGlutenText !== "â€“") lines.push("- Suma glutenu: " + sumGlutenText + " g");
  if (glutenPctText !== "â€“") lines.push("- Aktualny % glutenu mieszanki: " + glutenPctText + " %");

  lines.push("");
  lines.push("Zakwas / levain:");
  if (L > 0) lines.push("- IloÅ›Ä‡ levain: " + L.toFixed(1) + " g");
  if (Lh > 0) lines.push("- Hydratacja levain: " + Lh.toFixed(1) + " %");
  if (levFlourText !== "â€“") lines.push("- MÄ…ka w levain: " + levFlourText + " g");
  if (levWaterText !== "â€“") lines.push("- Woda w levain: " + levWaterText + " g");

  lines.push("");
  lines.push("Hydratacja ciasta:");
  if (targetHydro > 0) lines.push("- Docelowa hydratacja: " + targetHydro.toFixed(1) + " %");
  if (totalFlourText !== "â€“") lines.push("- CaÅ‚kowita mÄ…ka: " + totalFlourText + " g");
  if (totalWaterText !== "â€“") lines.push("- CaÅ‚kowita woda: " + totalWaterText + " g");
  if (addedWaterText !== "â€“") lines.push("- Woda do dodania do ciasta: " + addedWaterText + " g");

  var summary = document.getElementById("recipeSummary");
  if (summary) summary.value = lines.join("\n");
}
</script>

</body>
</html>